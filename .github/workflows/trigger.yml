# .github/workflows/trigger.yml
name: Repository Dispatch API Trigger

on:
  workflow_dispatch:
jobs:
  trigger-dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Trigger repository dispatch via API
        run: |
          curl -X POST \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            -H "Content-Type: application/json" \
            https://api.github.com/repos/${{ github.repository }}/dispatches \
            -d '{
              "event_type": "${{ github.event.inputs.event_type || 'custom-event' }}",
              "client_payload": {
                "message": "${{ github.event.inputs.message || 'Hello from API trigger!' }}",
                "sender": "${{ github.actor }}",
                "timestamp": "${{ github.run_id }}",
                "repository": "${{ github.repository }}",
                "workflow_run_id": "${{ github.run_id }}"
              }
            }'
      
      - name: Confirm API call
        run: |
          echo " Repository dispatch envoy√© via API GitHub"
          echo "Event type: ${{ github.event.inputs.event_type || 'custom-event' }}"
          echo "Message: ${{ github.event.inputs.message || 'Hello from API trigger!' }}"
          echo "Repository: ${{ github.repository }}"